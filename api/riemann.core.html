<!DOCTYPE html>
<html><head><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>riemann.core documentation</title></head><body><div id="header"><h1><a href="index.html">Riemann 0.2.13-SNAPSHOT API documentation</a></h1></div><div class="sidebar" id="namespaces"><h3><span>Namespaces</span></h3><ul><li><a href="riemann.bin.html"><span>riemann.bin</span></a></li><li><a href="riemann.blueflood.html"><span>riemann.blueflood</span></a></li><li><a href="riemann.boundary.html"><span>riemann.boundary</span></a></li><li><a href="riemann.campfire.html"><span>riemann.campfire</span></a></li><li><a href="riemann.cloudwatch.html"><span>riemann.cloudwatch</span></a></li><li><a href="riemann.common.html"><span>riemann.common</span></a></li><li><a href="riemann.config.html"><span>riemann.config</span></a></li><li class="current"><a href="riemann.core.html"><span>riemann.core</span></a></li><li><a href="riemann.datadog.html"><span>riemann.datadog</span></a></li><li><a href="riemann.deps.html"><span>riemann.deps</span></a></li><li><a href="riemann.druid.html"><span>riemann.druid</span></a></li><li><a href="riemann.elasticsearch.html"><span>riemann.elasticsearch</span></a></li><li><a href="riemann.email.html"><span>riemann.email</span></a></li><li><a href="riemann.expiration.html"><span>riemann.expiration</span></a></li><li><a href="riemann.folds.html"><span>riemann.folds</span></a></li><li><a href="riemann.graphite.html"><span>riemann.graphite</span></a></li><li><a href="riemann.hipchat.html"><span>riemann.hipchat</span></a></li><li><a href="riemann.index.html"><span>riemann.index</span></a></li><li><a href="riemann.influxdb.html"><span>riemann.influxdb</span></a></li><li><a href="riemann.instrumentation.html"><span>riemann.instrumentation</span></a></li><li><a href="riemann.kairosdb.html"><span>riemann.kairosdb</span></a></li><li><a href="riemann.keenio.html"><span>riemann.keenio</span></a></li><li><a href="riemann.librato.html"><span>riemann.librato</span></a></li><li><a href="riemann.logentries.html"><span>riemann.logentries</span></a></li><li><a href="riemann.logging.html"><span>riemann.logging</span></a></li><li><a href="riemann.logstash.html"><span>riemann.logstash</span></a></li><li><a href="riemann.mailgun.html"><span>riemann.mailgun</span></a></li><li><a href="riemann.nagios.html"><span>riemann.nagios</span></a></li><li><a href="riemann.opentsdb.html"><span>riemann.opentsdb</span></a></li><li><a href="riemann.opsgenie.html"><span>riemann.opsgenie</span></a></li><li><a href="riemann.pagerduty.html"><span>riemann.pagerduty</span></a></li><li><a href="riemann.plugin.html"><span>riemann.plugin</span></a></li><li><a href="riemann.pool.html"><span>riemann.pool</span></a></li><li><a href="riemann.prometheus.html"><span>riemann.prometheus</span></a></li><li><a href="riemann.pubsub.html"><span>riemann.pubsub</span></a></li><li><a href="riemann.pushover.html"><span>riemann.pushover</span></a></li><li><a href="riemann.query.html"><span>riemann.query</span></a></li><li><a href="riemann.repl.html"><span>riemann.repl</span></a></li><li><a href="riemann.service.html"><span>riemann.service</span></a></li><li><a href="riemann.shinken.html"><span>riemann.shinken</span></a></li><li><a href="riemann.slack.html"><span>riemann.slack</span></a></li><li><a href="riemann.sns.html"><span>riemann.sns</span></a></li><li><a href="riemann.stackdriver.html"><span>riemann.stackdriver</span></a></li><li><a href="riemann.streams.html"><span>riemann.streams</span></a></li><li><a href="riemann.test.html"><span>riemann.test</span></a></li><li><a href="riemann.time.html"><span>riemann.time</span></a></li><li><a href="riemann.time.controlled.html"><span>riemann.time.controlled</span></a></li><li><a href="riemann.transport.html"><span>riemann.transport</span></a></li><li><a href="riemann.transport.debug.html"><span>riemann.transport.debug</span></a></li><li><a href="riemann.transport.graphite.html"><span>riemann.transport.graphite</span></a></li><li><a href="riemann.transport.opentsdb.html"><span>riemann.transport.opentsdb</span></a></li><li><a href="riemann.transport.sse.html"><span>riemann.transport.sse</span></a></li><li><a href="riemann.transport.tcp.html"><span>riemann.transport.tcp</span></a></li><li><a href="riemann.transport.udp.html"><span>riemann.transport.udp</span></a></li><li><a href="riemann.transport.websockets.html"><span>riemann.transport.websockets</span></a></li><li><a href="riemann.twilio.html"><span>riemann.twilio</span></a></li><li><a href="riemann.victorops.html"><span>riemann.victorops</span></a></li><li><a href="riemann.xymon.html"><span>riemann.xymon</span></a></li></ul></div><div class="sidebar" id="vars"><h3>Public Vars</h3><ul><li><a href="riemann.core.html#var--%3ECore"><span>-&gt;Core</span></a></li><li><a href="riemann.core.html#var-conj-service"><span>conj-service</span></a></li><li><a href="riemann.core.html#var-core"><span>core</span></a></li><li><a href="riemann.core.html#var-core-services"><span>core-services</span></a></li><li><a href="riemann.core.html#var-delete-from-index"><span>delete-from-index</span></a></li><li><a href="riemann.core.html#var-instrumentation-service"><span>instrumentation-service</span></a></li><li><a href="riemann.core.html#var-map-%3ECore"><span>map-&gt;Core</span></a></li><li><a href="riemann.core.html#var-merge-cores"><span>merge-cores</span></a></li><li><a href="riemann.core.html#var-reaper"><span>reaper</span></a></li><li><a href="riemann.core.html#var-start%21"><span>start!</span></a></li><li><a href="riemann.core.html#var-stop%21"><span>stop!</span></a></li><li><a href="riemann.core.html#var-stream%21"><span>stream!</span></a></li><li><a href="riemann.core.html#var-transition%21"><span>transition!</span></a></li><li><a href="riemann.core.html#var-update-index"><span>update-index</span></a></li><li><a href="riemann.core.html#var-wrap-index"><span>wrap-index</span></a></li></ul></div><div class="namespace-docs" id="content"><h2>riemann.core documentation</h2><pre class="doc">Binds together an index, servers, and streams.
</pre><div class="public" id="var--%3ECore"><h3>-&gt;Core</h3><div class="usage"><code>(-&gt;Core streams services index pubsub streaming-metric)</code></div><pre class="doc">Positional factory function for class riemann.core.Core.
</pre></div><div class="public" id="var-conj-service"><h3>conj-service</h3><div class="usage"><code>(conj-service core service)</code><code>(conj-service core service force?)</code></div><pre class="doc">Adds a service to a core. Throws if any existing services would conflict. If
force? is passed, dissoc's any conflicting services.</pre></div><div class="public" id="var-core"><h3>core</h3><div class="usage"><code>(core)</code></div><pre class="doc">Create a new core.
</pre></div><div class="public" id="var-core-services"><h3>core-services</h3><div class="usage"><code>(core-services core)</code></div><pre class="doc">All services in a core--both the :services list and named services like the
index.</pre></div><div class="public" id="var-delete-from-index"><h3>delete-from-index</h3><div class="usage"><code>(delete-from-index core event)</code><code>(delete-from-index core fields event)</code></div><pre class="doc">Deletes similar events from the index. By default, deletes events with the
same host and service. If a field, or a list of fields, is given, deletes any
events with matching values for all of those fields.

; Delete all events in the index with the same host
(delete-from-index index :host event)

; Delete all events in the index with the same host and state.
(delete-from-index index [:host :state] event)</pre></div><div class="public" id="var-instrumentation-service"><h3>instrumentation-service</h3><div class="usage"><code>(instrumentation-service opts)</code></div><pre class="doc">Returns a service which samples instrumented services in its core every
interval seconds, and sends their events to the core itself.</pre></div><div class="public" id="var-map-%3ECore"><h3>map-&gt;Core</h3><div class="usage"><code>(map-&gt;Core m__6522__auto__)</code></div><pre class="doc">Factory function for class riemann.core.Core, taking a map of keywords to field values.
</pre></div><div class="public" id="var-merge-cores"><h3>merge-cores</h3><div class="usage"><code>(merge-cores old-core new-core)</code></div><pre class="doc">Merge cores old-core and new-core into a new core comprised of services from
:new-core or their equivalents from :old-core where possible.</pre></div><div class="public" id="var-reaper"><h3>reaper</h3><div class="usage"><code>(reaper)</code><code>(reaper interval)</code><code>(reaper interval opts)</code></div><pre class="doc">Returns a service which expires states from its core's index every interval
(default 10) seconds. Expired events are streamed to the core's streams. The
streamed states have only the host and service copied, current time, and
state expired. Expired events from the index are also published to the
&quot;index&quot; pubsub channel.

Options:

:keep-keys A list of event keys which should be preserved from the indexed
           event in the expired event. Defaults to [:host :service], which
           means that when an event expires, its :host and :service are
           copied to a new event, but no other keys are preserved.

           The state of an expired event is always &quot;expired&quot;, and its time
           is always the time that the event expired.</pre></div><div class="public" id="var-start%21"><h3>start!</h3><div class="usage"><code>(start! core)</code></div><pre class="doc">Start the given core. Reloads and starts all services.
</pre></div><div class="public" id="var-stop%21"><h3>stop!</h3><div class="usage"><code>(stop! core)</code></div><pre class="doc">Stops the given core and all services.
</pre></div><div class="public" id="var-stream%21"><h3>stream!</h3><div class="usage"><code>(stream! core event)</code></div><pre class="doc">Applies an event to the streams in this core.
</pre></div><div class="public" id="var-transition%21"><h3>transition!</h3><div class="usage"><code>(transition! old-core new-core)</code></div><pre class="doc">A core transition &quot;merges&quot; one core into another. Cores are immutable,
but the stateful resources associated with them aren't. When you call
(transition! old-core new-core), we:

1. Stop old core services without an equivalent in the new core.

2. Merge the new core's services with equivalents from the old core.

3. Reload all services with the merged core.

4. Start all services in the merged core.

Finally, we return the merged core. old-core and new-core can be discarded.</pre></div><div class="public" id="var-update-index"><h3>update-index</h3><div class="usage"><code>(update-index core event)</code></div><pre class="doc">Updates this core's index with an event.
</pre></div><div class="public" id="var-wrap-index"><h3>wrap-index</h3><div class="usage"><code>(wrap-index source)</code><code>(wrap-index source registry)</code></div><pre class="doc">Wraps an index, exposing the normal Index and IFn protocols. If a second
argument is present it should implement the PubSub interface and will be
notified when events are updated in the index.</pre></div></div></body></html>